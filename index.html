<html>
<head>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mousetrap/1.6.5/mousetrap.min.js" integrity="sha512-+Jg3Ynmj9hse704K48H6rBBI3jdNBjReRGBCxUWFfOz3yVurnJFWtAWssDAsGtzWYw89xFWPxShuj2T6E9EOpg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
	Mousetrap.bind('4', function() { alert('4'); });
</script>
<script>
window.state = {
  "UI": {
    "showModal": false,
    "selectedTopicId": null,
    "selectedTaskId": null,
    "search": null,
    "displayTopics": null,
    "maxDisplayTopics": 3,
  },
	"topics": {
		"e5551556729859762485": {
      "UI":{
        "showTasks": false,
        "SeeMessage": "see tasks ↓",
        "HiddeMessage": "hidde tasks ↑",
        "AddTaskMessage": "add task +",
      },
			"completed": 50,
			"score": 72,
			"name": "What did you do today?",
			"tasks": {
				"1730789376726802856": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe your morning routine",
					"score": 82
				},
				"1827391674184217122": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe another daily routine",
					"score": 47
				},
				"1827391674184217123": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What did you have for breakfast?",
					"score": 60
				},
				"1827391674184217124": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "How did you commute to work?",
					"score": 75
				},
				"1827391674184217125": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe a challenge you faced today",
					"score": 55
				},
				"1827391674184217126": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What did you have for lunch?",
					"score": 68
				},
				"1827391674184217127": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe your evening routine",
					"score": 80
				},
				"1827391674184217128": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What did you have for dinner?",
					"score": 74
				},
				"1827391674184217129": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What time did you go to bed?",
					"score": 83
				},
				"1827391674184217130": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe a moment that made you happy today",
					"score": 90
				}
			}
		},
		"a7845123401278956432": {
      "UI":{
        "showTasks": false,
        "SeeMessage": "see tasks ↓",
        "HiddeMessage": "hidde tasks ↑",
        "AddTaskMessage": "add task +",
      },
			"completed": 70,
			"score": 85,
			"name": "Favorite Hobbies",
			"tasks": {
				"1930845623482348956": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe your favorite hobby",
					"score": 90
				},
				"1857389461283476122": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe a hobby you want to learn",
					"score": 75
				},
				"1857389461283476123": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "How did you get started with your hobby?",
					"score": 88
				},
				"1857389461283476124": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What do you love most about your hobby?",
					"score": 95
				},
				"1857389461283476125": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe a memorable moment related to your hobby",
					"score": 80
				},
				"1857389461283476126": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "How often do you practice your hobby?",
					"score": 70
				},
				"1857389461283476127": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Who do you share your hobby with?",
					"score": 85
				},
				"1857389461283476128": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What is a challenge you face with your hobby?",
					"score": 77
				},
				"1857389461283476129": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe a goal you have for your hobby",
					"score": 92
				},
				"1857389461283476130": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What equipment or tools do you use for your hobby?",
					"score": 65
				}
			}
		},
		"b6758493021874956123": {
      "UI":{
        "showTasks": false,
        "SeeMessage": "see tasks ↓",
        "HiddeMessage": "hidde tasks ↑",
        "AddTaskMessage": "add task +",
      },
			"completed": 60,
			"score": 78,
			"name": "Travel Experiences",
			"tasks": {
				"1976432863124985607": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe your favorite travel destination",
					"score": 88
				},
				"1867349124873246122": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe a place you want to visit",
					"score": 68
				},
				"1867349124873246123": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What was your first travel experience?",
					"score": 85
				},
				"1867349124873246124": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What is the most memorable trip you've had?",
					"score": 90
				},
				"1867349124873246125": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe a travel mishap you experienced",
					"score": 60
				},
				"1867349124873246126": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What kind of traveler are you?",
					"score": 78
				},
				"1867349124873246127": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What do you love most about traveling?",
					"score": 95
				},
				"1867349124873246128": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Who is your favorite travel companion?",
					"score": 83
				},
				"1867349124873246129": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe a cultural experience you had while traveling",
					"score": 87
				},
				"1867349124873246130": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What is the best food you’ve eaten while traveling?",
					"score": 80
				}
			}
		},
		"c8923746512378945621": {
      "UI":{
        "showTasks": false,
        "SeeMessage": "see tasks ↓",
        "HiddeMessage": "hidde tasks ↑",
        "AddTaskMessage": "add task +",
      },
			"completed": 80,
			"score": 92,
			"name": "Professional Goals",
			"tasks": {
				"1983475623482398765": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe your current job",
					"score": 95
				},
				"1873948561239476123": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe your dream job",
					"score": 89
				},
				"1873948561239476124": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What skills are you working on to achieve your goals?",
					"score": 90
				},
				"1873948561239476125": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Who inspires you professionally?",
					"score": 85
				},
				"1873948561239476126": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe a professional challenge you overcame",
					"score": 75
				},
				"1873948561239476127": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What are your short-term professional goals?",
					"score": 82
				},
				"1873948561239476128": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What are your long-term professional goals?",
					"score": 88
				},
				"1873948561239476129": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "Describe a project you are proud of",
					"score": 92
				},
				"1873948561239476130": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "What is your approach to networking?",
					"score": 70
				},
				"1873948561239476131": { 
          "UI": {
            "GoMessage": "go to task →",
          },
					"name": "How do you balance work and personal life?",
					"score": 78
				}
			}
		}
	}
}
window.state.UI.displayTopics=Object.keys(window.state.topics).slice(0,window.state.UI.maxDisplayTopics) 

</script>
<style>
.backgroundimg {
  z-index: -1;
}
#content {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 10px;
}

.topic {
  border-radius: 15px;
  background: #ff6f61;
  width: 300px;
  height: 40vh;
  margin-bottom: 20px;
  padding: 10px;
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
  transition: transform 0.3s, box-shadow 0.3s;
  transform-style: preserve-3d;
}

.topic:hover {
  background: #ff5a4d;
  transform: translateZ(20px) scale(1.05);
  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.3);
}

.task {
  margin-top: 10px;
  margin-left: 20px;
  border-radius: 15px;
  background: #ffa500;
  width: 280px;
  height: 25vh;
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
  transition: transform 0.3s, box-shadow 0.3s;
  transform-style: preserve-3d;
}

.task:hover {
  background: #e69500;
  transform: translateZ(15px) scale(1.03);
  box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.3);
}
.task.hide {
	display: none;
}
#app.hide {
  display: none
}

* {
  box-sizing: border-box;
}

/* Create four equal columns that floats next to each other */
.column {
  float: left;
  padding: 10px;
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}
.search-container {
    display: flex;
    align-items: center;
    width: 300px; /* Adjust the width as needed */
    border: 2px solid #ccc;
    border-radius: 25px;
    padding: 5px;
}

.search-container i {
    font-size: 20px;
    color: #333;
    margin-right: 10px;
}

.search-container input {
    border: none;
    outline: none;
    width: 100%;
    padding: 5px;
    font-size: 16px;
}
/* Carousel container */
.carousel-container {
  position: relative;
  width: 100%;
  overflow: hidden;
}

/* Carousel wrapper */
.carousel-wrapper {
  display: flex;
  transition: transform 0.3s ease-in-out;
}

/* Topic column styling */
.column {
  flex: 0 0 auto; /* Prevent columns from shrinking or growing */
  width: 300px;   /* Adjust the width of each topic box */
  margin-right: 20px; /* Space between columns */
}

/* Carousel navigation buttons */
.carousel-button {
  position: absolute;
  top: 10vh;
  background-color: rgba(0, 0, 0, 0.5);
  color: #fff;
  border: none;
  border-radius: 50%;
  padding: 10px;
  cursor: pointer;
  z-index: 10;
}

.carousel-button.left {
  left: 10px;
}

.carousel-button.right {
  right: 10px;
}

</style>
</head>
<body>
   <div id="content">
    <div id="app">
    </div>
  </div>
  <script>
    function onClickCarrouselLeftButton() {
        } 
    function onClickCarrouselRightButton() {
    }
    function onClickModalGoBack() {
      document.getElementById('app').classList.remove('hide');
      document.getElementById('app-modal').remove()
      window.store.dispatch({
            type: '',
            payload: {
                      "showModal": false,
                      "selectedTopicId": null,
                      "selectedTaskId": null,
                     }
      })
    }
    function onClickTaskSeeTaskButton (topicId, taskId){
      document.getElementById('app').classList.add('hide');
      window.store.dispatch({type: 'GO_TO_TASK',
                             payload: { 
                               topicId: `${topicId}`,
                               taskId: `${taskId}`, 
                             }
                           })
    }
  </script>
  <script type="module">
    import * as Redux from 'https://unpkg.com/redux@latest/dist/redux.browser.mjs'

    function reducer(state, action) {
        switch (action.type) {
          case 'ADD_TASK':
            const newTask = action.payload.task;
            return {
              ...state
            }
	  case 'DISPLAY_PREV_TOPICS':
	    var keys = Object.keys(state.topics)
	    var curr_display_first_id = state.UI.displayTopics[0]
	    var curr_display_start_idx = keys.indexOf(curr_display_first_id) 
	    if(curr_display_start_idx === 0){ 
	      var new_state = state
	    }
	    else{
	      var new_display_first_idx = curr_display_start_idx-1
	      var new_display_last_idx = curr_display_start_idx + state.UI.maxDisplayTopics - 1
	      var newdisplaytopics=keys.slice(new_display_first_idx,new_display_last_idx)
	      var new_state = {
		      ...state,
		      UI: {
			...state.UI,
			displayTopics:newdisplaytopics	
		      }
	       }
            }
   	    return new_state
	  case 'DISPLAY_NEXT_TOPICS':
	    var keys = Object.keys(state.topics)
	    var curr_display_last_id = state.UI.displayTopics[state.UI.displayTopics.length-1]
	    var curr_display_last_idx = keys.indexOf(curr_display_last_id) 
	    if(curr_display_last_idx === keys.length - 1 ){ 
	      var new_state = state
	    }
	    else{
	      var new_display_last_idx = curr_display_last_idx+1
	      var temp = new_display_last_idx - state.UI.maxDisplayTopics + 1
	      var new_display_first_idx = temp > 0 ? temp : 0 
	      var newdisplaytopics=keys.slice(new_display_first_idx,new_display_last_idx+1)
	      var new_state = {
		      ...state,
		      UI: {
			...state.UI,
			displayTopics:newdisplaytopics	
		      }
	      }
            }
   	    return new_state
		
          case 'GO_TO_TASK':
            var new_state = {
              ...state,
              UI: {
                ...state.UI,
                "showModal": true,
                "selectedTopicId": action.payload.topicId,
                "selectedTaskId": action.payload.taskId
              }
            }
            return new_state;
          case 'TOGGLE_TASKS':
            var new_state = {
              ...state,
              topics: {
                ...state.topics,
                [action.payload.topicId]: {
                  ...state.topics[action.payload.topicId],
                  UI: {
                    ...state.topics[action.payload.topicId].UI,
                    showTasks: !state.topics[action.payload.topicId].UI.showTasks
                  }
                }
              }
            };
            console.log(new_state)
            console.log(action.payload.topicId)
            return new_state; 
          default:
            return state
        }
    }

    window.store = Redux.createStore(reducer, window.state);

  function render(state, action) {
    switch (action.type) {
      case 'RENDER_MODAL': {
        // Existing modal rendering code
        break;
      }
      default: {
        const appEl = document.getElementById('app');
        if (appEl.childElementCount > 0) {
          while (appEl.firstChild) {
            appEl.removeChild(appEl.firstChild);
          }
        }

        const searchBarEl = document.createElement('div');
        searchBarEl.innerHTML = `
        <div style="width:50%;margin:10px auto;">
            <div class="search-container">
                <i>?</i> <!-- You can replace this with an actual icon using a library like Font Awesome -->
                <input type="text" placeholder="Search...">
            </div>
          <label for="vehicle1">Show hidden tasks</label>
          <input type="checkbox" id="vehicle1" name="vehicle1" value="Bike">
        </div>
        `
        appEl.append(searchBarEl);
        // Create carousel container
        const carouselContainerEl = document.createElement('div');
        carouselContainerEl.classList.add('carousel-container');

        // Create carousel wrapper
        const carouselWrapperEl = document.createElement('div');
	carouselWrapperEl.setAttribute("id","carouselWrapper")
        carouselWrapperEl.classList.add('carousel-wrapper');
        
        // Add topics to carousel wrapper
        for (const topicId of state.UI.displayTopics ) {
          const topicData = state.topics[topicId];
          // topic-column
          const topicColumnEl = document.createElement('div');
          topicColumnEl.classList.add('column');
          topicColumnEl.id = `topic-column-${topicId}`;

          // topic-box
          const topicBoxEl = document.createElement('div');
          topicBoxEl.classList.add('topic');
          topicBoxEl.id = `topic-box-${topicId}`;
          topicBoxEl.innerHTML = `
            <p style="text-align:center;">${topicData.name}</p>
            <div style="width:80%;margin:10px auto;" class="w3-light-grey w3-round-xlarge">
              <div class="w3-container w3-blue w3-round-xlarge" style="width:${topicData.completed}%;font-size:.8vw;">${topicData.completed}% Completed</div>
            </div>
            <div style="width:80%;margin:10px auto;" class="w3-light-grey w3-round-xlarge">
              <div class="w3-container w3-blue w3-round-xlarge" style="width:${topicData.score}%;font-size:.8vw;">${topicData.score} Score</div>
            </div>
            <button class="seetask" onclick="window.store.dispatch({type: 'TOGGLE_TASKS', payload: { topicId: '${topicId}' }})" style="float:right;margin-left:5px;"> ${ topicData.UI.showTasks ? topicData.UI.HiddeMessage : topicData.UI.SeeMessage } </button>
          `;
          
          topicColumnEl.append(topicBoxEl);
          
          for (const taskId in topicData.tasks) {
            const taskData = topicData.tasks[taskId];
            const taskEl = document.createElement('div');
            taskEl.classList.add('task');
            topicData.UI.showTasks ? taskEl.classList.remove("hide") : taskEl.classList.add("hide")  
            taskEl.id = `task-${taskId}`;
            taskEl.innerHTML = `
              <p style="text-align:center;">${taskData.name}</p>
              <div style="width:80%;margin:10px auto;" class="w3-light-grey w3-round-xlarge">
                <div class="w3-container w3-blue w3-round-xlarge" style="width:${taskData.score}%;font-size:.8vw;">${taskData.score} Score</div>
              </div>
              <button class="seetask" onClick="onClickTaskSeeTaskButton('${topicId}', '${taskId}')"  style="float:right;margin-left:5px;"> ${taskData.UI.GoMessage}</button>
            `;
            topicColumnEl.append(taskEl);
          }

          carouselWrapperEl.append(topicColumnEl);
        }

        carouselContainerEl.append(carouselWrapperEl);

        const leftButtonEl = document.createElement('button');
        leftButtonEl.classList.add('carousel-button', 'left');
        leftButtonEl.innerHTML =  `<p onClick="window.store.dispatch({type: 'DISPLAY_PREV_TOPICS'})">&#10094;</p>`; // left arrow

        const rightButtonEl = document.createElement('button');
        rightButtonEl.classList.add('carousel-button', 'right');
        rightButtonEl.innerHTML =  `<p onClick="window.store.dispatch({type: 'DISPLAY_NEXT_TOPICS'})">&#10095;</p>`; // Right arrow

        appEl.append(leftButtonEl, rightButtonEl);
        appEl.append(carouselContainerEl);
      }
    }
  }
    render(window.store.getState(), { type: 'INIT' });
    store.subscribe(() => {
      const state = window.store.getState();
      const action = state.UI.showModal ? { type: 'RENDER_MODAL' } : { type: 'RENDER_ALL' };
      render(state, action);
    });
  </script>
</body>
</html>

